{
  "category": "Uncategorized",
  "description": "Correct Calendar Day Display Error\n\nThe calendar component is incorrectly displaying Wednesday as the current day when today is actually Tuesday. Fix the date calculation or display logic to show the correct current day.\n\nRequirements:\n- Identify where the calendar determines and displays the current day\n- Check for timezone-related issues that might cause off-by-one day errors\n- Verify the date source (client system time vs server time vs hardcoded value)\n- Ensure the day calculation accounts for locale and timezone settings\n- Test that the current day indicator updates correctly at midnight\n- Verify the fix works across different timezones\n- Confirm other calendar functionality (date selection, navigation) still works correctly\n\nEdge cases to consider:\n- Users in different timezones viewing the calendar\n- Daylight saving time transitions\n- Date rollover at midnight\n- Server and client time mismatches",
  "title": "Fix calendar day display off-by-one error",
  "images": [],
  "imagePaths": [],
  "textFilePaths": [],
  "skipTests": true,
  "model": "claude-opus",
  "thinkingLevel": "none",
  "reasoningEffort": "none",
  "branchName": "main",
  "priority": 2,
  "planningMode": "skip",
  "requirePlanApproval": false,
  "dependencies": [],
  "workMode": "current",
  "titleGenerating": false,
  "status": "verified",
  "id": "feature-1770780308909-sqbzph0smn",
  "descriptionHistory": [
    {
      "description": "Correct Calendar Day Display Error\n\nThe calendar component is incorrectly displaying Wednesday as the current day when today is actually Tuesday. Fix the date calculation or display logic to show the correct current day.\n\nRequirements:\n- Identify where the calendar determines and displays the current day\n- Check for timezone-related issues that might cause off-by-one day errors\n- Verify the date source (client system time vs server time vs hardcoded value)\n- Ensure the day calculation accounts for locale and timezone settings\n- Test that the current day indicator updates correctly at midnight\n- Verify the fix works across different timezones\n- Confirm other calendar functionality (date selection, navigation) still works correctly\n\nEdge cases to consider:\n- Users in different timezones viewing the calendar\n- Daylight saving time transitions\n- Date rollover at midnight\n- Server and client time mismatches",
      "timestamp": "2026-02-11T03:25:09.028Z",
      "source": "initial"
    }
  ],
  "startedAt": "2026-02-11T03:25:16.060Z",
  "updatedAt": "2026-02-11T03:28:39.264Z",
  "justFinishedAt": "2026-02-11T03:28:39.251Z",
  "summary": "## Summary: Correct Calendar Day Display Error\n\n### Changes Implemented\n- Fixed the `formatDateString` function in all calendar-related components to use local timezone instead of UTC\n- The root cause was using `toISOString()` which converts dates to UTC, causing an off-by-one day error for users in timezones behind UTC (e.g., showing Wednesday when it's actually Tuesday in EST)\n- Replaced `date.toISOString().split('T')[0]` with a local timezone-aware implementation using `date.getFullYear()`, `date.getMonth()`, and `date.getDate()`\n- Added `T12:00:00` noon offset when parsing date strings from YYYY-MM-DD format to avoid edge cases during DST transitions\n\n### Files Modified\n- `src/app/calendar/page.tsx` - Fixed `formatDateString` function (line 19-24)\n- `src/components/habits/HabitCalendar.tsx` - Fixed `formatDateString` function (line 23-28)\n- `src/components/habits/HabitCalendarHeatmap.tsx` - Fixed `formatDateString` function (line 25-30)\n- `src/components/habits/DailyCheckIn.tsx` - Fixed `getTodayDate`, `getStartOfWeek`, `getEndOfWeek`, and `getEndOfMonth` functions (lines 35-75)\n\n### Notes for Developer\n- The fix ensures consistent date handling across all calendar components regardless of user timezone\n- The noon offset (`T12:00:00`) when parsing date strings is a common pattern to avoid DST edge cases where midnight might shift to the previous/next day\n- This fix will work correctly across different timezones, including during DST transitions\n- The date format (YYYY-MM-DD) remains unchanged for database compatibility"
}